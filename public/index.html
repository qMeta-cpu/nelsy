<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nelsy - The app that helps build your image on internet</title>
    <style>
        /* Reset et styles de base */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Arial', sans-serif;
        }
        
        body {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }
        
        /* Header */
        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 5%;
            border-bottom: 1px solid #eee;
        }
        
        .logo img {
            height: 30px;
        }
        
        nav {
            display: flex;
            align-items: center;
            gap: 30px;
        }
        
        nav a {
            text-decoration: none;
            color: #333;
            font-weight: 500;
        }
        
        .cta-button {
            background-color: #000;
            color: white;
            padding: 10px 20px;
            border-radius: 5px;
            text-decoration: none;
            font-weight: bold;
        }
        
        /* Main content - Page d'accueil */
        .home-page {
            flex: 1;
            padding: 50px 5%;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        .analysis-section {
            width: 100%;
            max-width: 800px;
            display: flex;
            gap: 20px;
            margin-top: 50px;
            align-items: center;
        }
        
        .input-area {
            flex: 1;
            height: 50px;
        }
        
        .input-area textarea {
            width: 100%;
            height: 100%;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
            resize: none;
            font-size: 16px;
        }
        
        .analyze-button {
            background-color: #000;
            color: white;
            border: none;
            padding: 0 30px;
            border-radius: 5px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            height: 50px;
            transition: all 0.3s ease;
        }
        
        .analyze-button:hover {
            background-color: #333;
        }
        
        .analyze-button:disabled {
            background-color: #ccc;
            cursor: not-allowed;
        }
        
        /* Page de résultats SEO */
        .seo-results-page {
            flex: 1;
            padding: 50px 5%;
            display: none;
            flex-direction: column;
            max-width: 1200px;
            margin: 0 auto;
            animation: fadeIn 0.5s ease-out;
        }
        
        .score-container {
            display: flex;
            align-items: center;
            gap: 30px;
            margin-bottom: 40px;
        }
        
        .global-score {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            background: #f5f5f5;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            font-size: 24px;
            font-weight: bold;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        
        .global-score .score {
            font-size: 48px;
            color: #2ecc71;
        }
        
        .analysis-categories {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }
        
        .category-card {
            background: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .category-title {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .category-score {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: #f5f5f5;
            display: flex;
            justify-content: center;
            align-items: center;
            font-weight: bold;
        }
        
        .issues-list {
            list-style-type: none;
        }
        
        .issues-list li {
            padding: 8px 0;
            border-bottom: 1px solid #eee;
            display: flex;
            align-items: center;
        }
        
        .issue-severity {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 10px;
        }
        
        .critical { background-color: #e74c3c; }
        .warning { background-color: #f39c12; }
        .info { background-color: #3498db; }
        .success { background-color: #2ecc71; }
		

  /* Ajoutez ces règles à votre balise style existante */
  .seo-results {
    display: none;
    width: 100%;
    max-width: 1200px;
    margin-top: 40px;
    background: white;
    padding: 30px;
    border-radius: 8px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
  }
  
  .score-summary {
    display: flex;
    gap: 30px;
    margin-bottom: 30px;
    align-items: center;
  }
  
  .overall-score {
    width: 150px;
    height: 150px;
    border-radius: 50%;
    background: #f5f5f5;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    flex-shrink: 0;
  }
  
  #overall-score-value {
    font-size: 42px;
    font-weight: bold;
  }
  
  .category-scores {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
    gap: 20px;
  }
  
  .category-card {
    background: #f9f9f9;
    padding: 15px;
    border-radius: 8px;
  }

        
        /* Footer */
        footer {
            background-color: #f8f8f8;
            padding: 30px 5%;
            display: flex;
            justify-content: space-between;
        }
        
        .footer-links {
            display: flex;
            gap: 20px;
        }
        
        .footer-links a {
            text-decoration: none;
            color: #666;
        }
        
        .copyright {
            color: #666;
        }
        
        /* Loader et animations */
        .loader {
            display: inline-block;
            width: 15px;
            height: 15px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #000;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-right: 8px;
            vertical-align: middle;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .analysis-section {
                flex-direction: column;
            }
            
            .input-area {
                width: 100%;
            }
            
            .analyze-button {
                width: 100%;
                padding: 15px;
            }
            
            .score-container {
                flex-direction: column;
                text-align: center;
            }
        }
    </style>
</head>
<body>
    <header>
        <a href="/" class="logo">
            <img src="image/logo.png" alt="Nelsy.app">
        </a>
        <nav>
            <a href="#" onclick="showHomePage()">Home</a>
            <a href="#">Pricing</a>
            <a href="#">Sourcing</a>
            <a href="#">Contact</a>
            <a href="#" class="cta-button">S'inscrire</a>
        </nav>
    </header>
    
    <main class="home-page" id="homePage">
        <h1>Data extraction, organization, and analytics. Flexible solutions. Fast and easy to use environment.</h1>
        <p></p>
        
        <div class="analysis-section">
            <div class="input-area">
                <textarea id="contentToAnalyze" placeholder="Enter your URL (e.g., https://example.com)..." rows="1"></textarea>
            </div>
            <button class="analyze-button" onclick="analyzeContent()">Analyze</button>
        </div> 
		

</div>
		
    </main>
    
      <main class="seo-results-page" id="seoResultsPage">
        <h1>Complete SEO Audit</h1>
        <p>We analyze your website to identify strengths, technical weaknesses, and optimization opportunities.</p>
        <br>
        <div class="score-container">
            <div class="global-score">
                <span class="score" id="overall-score">0</span>
                <span>/100</span>
            </div>
            <div>
                <h2>Overall Score</h2>
                <p id="score-description">Your score will appear here after analysis</p>
            </div>
        </div>
        
        <h2>Analysis Details</h2><br>
        
        <div class="analysis-categories" id="categories-container">
            <!-- Categories will be inserted here by JavaScript -->
        </div>
        
        <div class="category-card">
            <h3>Recommendations</h3>
            <ul class="issues-list" id="recommendations-list">
                <!-- Recommendations will be inserted here by JavaScript -->
            </ul>
        </div>
    </main>
    
    <footer>
        <div class="copyright">© 2025 Nelsy.app. All rights reserved.</div>
        <div class="footer-links">
            <a href="#">FAQ</a>
            <a href="#">Privacy</a>
            <a href="#">Terms</a>
        </div>
    </footer>

<script>
        // Configuration des catégories
        const categoriesConfig = [
            { 
                id: 'performance', 
                name: 'Performance', 
                color: '#e74c3c',
                defaultIssues: [
                    { message: 'High loading time', severity: 'warning' },
                    { message: 'Unoptimized images', severity: 'critical' }
                ]
            },
            { 
                id: 'seo', 
                name: 'Technical SEO', 
                color: '#f39c12',
                defaultIssues: [
                    { message: 'Missing meta tags', severity: 'warning' }
                ]
            },
            { 
                id: 'content', 
                name: 'Content', 
                color: '#2ecc71',
                defaultIssues: [
                    { message: 'Quality content found', severity: 'success' }
                ]
            },
            { 
                id: 'accessibility', 
                name: 'Accessibility', 
                color: '#3498db',
                defaultIssues: [
                    { message: 'Color contrast issues', severity: 'warning' }
                ]
            },
            { 
                id: 'security', 
                name: 'Security', 
                color: '#2ecc71',
                defaultIssues: [
                    { message: 'HTTPS properly configured', severity: 'success' }
                ]
            },
            { 
                id: 'mobile', 
                name: 'Mobile', 
                color: '#f39c12',
                defaultIssues: [
                    { message: 'Responsive design', severity: 'success' }
                ]
            }
        ];

        async function analyzeContent() {
            const url = document.getElementById('contentToAnalyze').value.trim();
            if (!url) {
                alert('Please enter a valid URL');
                return;
            }

            if (!/^https?:\/\/.+/i.test(url)) {
                alert('URL must start with http:// or https://');
                return;
            }

            const button = document.querySelector('.analyze-button');
            const originalText = button.textContent;
            button.innerHTML = '<span class="loader"></span> Analyzing...';
            button.disabled = true;

            try {
                const response = await fetch('/analyze', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ 
                        url,
                        options: {
                            lighthouse: {
                                skipUpdateCheck: true,
                                onlyCategories: ['performance', 'seo', 'accessibility', 'best-practices', 'pwa']
                            }
                        }
                    })
                });

                if (!response.ok) {
                    const error = await response.json();
                    throw new Error(error.message || 'Analysis failed');
                }

                const report = await response.json();
                console.log("Analysis report:", report);
                displayResults(report);
                
            } catch (error) {
                console.error('Error:', error);
                alert(`Analysis error: ${error.message}`);
            } finally {
                button.textContent = originalText;
                button.disabled = false;
            }
        }

        function displayResults(report) {
            console.log("Full report received:", report);
            
            if (!report || typeof report !== 'object') {
                console.error("Invalid report format");
                alert("Invalid analysis report received");
                return;
            }

            // Update overall score
            const overallScore = Math.round(report.score || 0);
            document.getElementById('overall-score').textContent = overallScore;
            document.getElementById('score-description').textContent = getScoreDescription(overallScore);
            
            // Generate categories HTML
            let categoriesHTML = '';
            
            categoriesConfig.forEach(category => {
                const categoryData = report[category.id] || {};
                const score = Math.round((categoryData.score || 0) * 100);
                const issues = categoryData.issues || category.defaultIssues || [];
                
                categoriesHTML += `
                <div class="category-card">
                    <div class="category-title">
                        <h3>${category.name}</h3>
                        <div class="category-score" style="color: ${getScoreColor(score)}">${score}</div>
                    </div>
                    <ul class="issues-list">
                        ${issues.map(issue => `
                            <li>
                                <span class="issue-severity ${issue.severity || 'info'}"></span>
                                ${issue.message}
                            </li>
                        `).join('')}
                    </ul>
                </div>`;
            });
            
            // Update DOM
            document.getElementById('categories-container').innerHTML = categoriesHTML;
            
            // Update recommendations
            const recList = document.getElementById('recommendations-list');
            recList.innerHTML = (report.recommendations || []).map(rec => `
                <li><span class="issue-severity ${rec.priority || 'warning'}"></span>${rec.message}</li>
            `).join('') || '<li>No specific recommendations</li>';
            
            // Show results
            document.getElementById('homePage').style.display = 'none';
            document.getElementById('seoResultsPage').style.display = 'flex';
            window.scrollTo(0, 0);
        }

        function getScoreDescription(score) {
            if (score >= 90) return "Excellent! Your site meets all best practices";
            if (score >= 70) return "Good, but there is room for improvement";
            if (score >= 50) return "Needs work, several issues found";
            return "Poor score, major improvements needed";
        }

        function getScoreColor(score) {
            if (score >= 90) return '#2ecc71';
            if (score >= 70) return '#f39c12';
            if (score >= 50) return '#e67e22';
            return '#e74c3c';
        }

        function showHomePage() {
            document.getElementById('seoResultsPage').style.display = 'none';
            document.getElementById('homePage').style.display = 'flex';
            document.getElementById('contentToAnalyze').value = '';
            window.scrollTo(0, 0);
        }

        // Test function (remove in production)
        function testWithMockData() {
            const mockReport = {
                score: 82,
                performance: {
                    score: 0.64,
                    issues: [
                        { message: "High loading time (3.2s)", severity: "critical" },
                        { message: "Unoptimized images detected", severity: "warning" },
                        { message: "Effective caching", severity: "success" }
                    ]
                },
                seo: {
                    score: 0.75,
                    issues: [
                        { message: "Missing meta description", severity: "warning" },
                        { message: "Proper heading structure", severity: "success" }
                    ]
                },
                content: {
                    score: 0.88,
                    issues: [
                        { message: "High quality content", severity: "success" },
                        { message: "Could use more secondary keywords", severity: "info" }
                    ]
                },
                accessibility: {
                    score: 0.79,
                    issues: [
                        { message: "Low color contrast in buttons", severity: "warning" },
                        { message: "Missing alt text on images", severity: "critical" }
                    ]
                },
                security: {
                    score: 0.91,
                    issues: [
                        { message: "HTTPS properly configured", severity: "success" },
                        { message: "No known vulnerabilities", severity: "success" }
                    ]
                },
                mobile: {
                    score: 0.72,
                    issues: [
                        { message: "Touch targets too small", severity: "warning" },
                        { message: "Responsive layout", severity: "success" }
                    ]
                },
                recommendations: [
                    { message: "Optimize images to reduce page size", priority: "critical" },
                    { message: "Add missing meta descriptions", priority: "warning" },
                    { message: "Improve color contrast for accessibility", priority: "warning" }
                ]
            };
            
            displayResults(mockReport);
        }
    </script>
</body>
</html>